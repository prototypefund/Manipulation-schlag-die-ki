<app>
    <header></header>
    <div id="intro"></div>
    <div id="round"></div>
    <div id="main"></div>
    <div id="answers"></div>
    <!--scoreboard id="human" name="DU" score={this.human.score} status={this.human.status} result={this.human.result}></scoreboard>
    <scoreboard id="machine" name="KI" score={this.machine.score} status={this.machine.status} result={this.machine.result}></scoreboard-->
    <footer></footer>


    <script>
        let game = this;
        let mounted = {};

        game.human = {"status": STATUS.NOT_STARTED, "score": 0, "result": null};
        game.machine = {"status": STATUS.NOT_STARTED, "score": 0, "result": null};

        game.startChallenge = function() {
            mounted.instructions.unmount(true);
            mounted.challenge = mountToId("main", "challenge", {"image": opts.image});

            mounted.answers.opts.disabled = false;
            mounted.answers.update();

            game.human.status = "waiting";
            game.machine.status = "waiting";
            game.update();

            // fake the AI
            setTimeout(game.machineFinished, 300);
        };

        game.humanFinished = function(result){
            mounted.answers.opts.disabled = true;
            game.human.status = STATUS.FINISHED;
            game.human.result = result;
            game.update();
        };


        game.machineFinished = function(){
            game.machine.status = STATUS.FINISHED;
            game.machine.result = RESULT.CORRECT;
            game.update();
        };

        game.startCountdown = function() {
            mounted.instructions.unmount(true);

            let answerConfig = {"answers": opts.answers, "correct": opts.correct,
                "disabled": true, "onselected": game.humanFinished};
            mounted.answers = mountToId("answers", "answers", answerConfig);

            mounted.countdown = mountToId("main", "countdown", {"length": 3, "ontimeout": game.startChallenge})
        };

        game.setup = function() {
            mounted.intro.unmount(false);

            mounted.round = mountToId("round", "round", {"round": 1});
            mounted.instructions = mountToId("main", "instructions", {"ontimeout": game.startChallenge});

            /*let answerConfig = {"answers": opts.answers, "correct": opts.correct,
                                "disabled": true, "onselected": game.humanFinished};
            mounted.answers = mountToId("answers", "answers", answerConfig);*/
        };


        game.intro = function() {
            mounted.intro = mountToId("intro", "intro", {"onclick": game.setup});
        };

        this.on("mount", game.intro);
    </script>

</app>

<round>
    <h2>Runde {opts.round}</h2>
</round>
